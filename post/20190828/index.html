
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>约束布局指北 | 非哥说</title>
<meta name="description" content="梦开始的地方">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="http://www.tianfeifei.com/favicon.ico?v=1568767943049">
<link rel="stylesheet" href="http://www.tianfeifei.com/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="http://www.tianfeifei.com">
        <img class="avatar" src="http://www.tianfeifei.com/images/avatar.png?v=1568767943049" alt="" width="32px" height="32px">
      </a>
      <a href="http://www.tianfeifei.com">
        <h1 class="site-title">非哥说</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="http://www.tianfeifei.com" class="menu purple-link">
            首页
          </a>
        
      
        
          <a href="http://www.tianfeifei.com/archives" class="menu purple-link">
            归档
          </a>
        
      
        
          <a href="http://www.tianfeifei.com/tags" class="menu purple-link">
            标签
          </a>
        
      
        
          <a href="http://www.tianfeifei.com/post/about/" class="menu purple-link">
            关于
          </a>
        
      
        
          <a class="menu purple-link" href="http://so.tianfeifei.com" class="menu" target="_blank">
            导航
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
            <div class="feature-container" style="background-image: url('http://www.tianfeifei.com/post-images/20190828.png')">
            </div>
          
          <h2 class="post-title">约束布局指北</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-08-28 12:03</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="http://www.tianfeifei.com/tag/android">
                    Android
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content">
            <p>灵魂画手的摩托车！</p>
<!-- more -->
<p>在开始之前先抛出一个常见的面试题：</p>
<blockquote>
<p>Android常用的开发布局有哪些？</p>
</blockquote>
<p>遇见问题随手一百度，张口就来<br>
<img src="http://www.tianfeifei.com/post-images/1566966946678.png" alt=""><br>
1.线性布局（LinearLayout）<br>
2.相对布局（RelativeLayout）<br>
3.帧布局（FrameLayout）<br>
4.绝对布局（AbsoluteLayout）<br>
5.表格布局（TableLayout）<br>
6.网格布局（GridLayout）</p>
<p>很多文章并没有把约束布局给添加进来，而是单独开篇。<br>
这里想说的是，我们要学会面向搜索引擎来构建自己的知识体系。</p>
<h1 id="为什么要使用约束布局">为什么要使用约束布局</h1>
<h2 id="目前存在的问题why">目前存在的问题（WHY）</h2>
<p>1.一些复杂的UI，可能会有层级嵌套过多的问题。<br>
2.没有办法兼容更多的屏幕尺寸。</p>
<h2 id="问题的解决方案how">问题的解决方案（HOW）</h2>
<p>1.使用<code>&lt;merge&gt;</code>标签；使用相对布局（RelativeLayout）；使用约束布局（ConstraintLayout）。<br>
2.使用屏幕适配方案；使用约束布局（ConstraintLayout）。</p>
<h2 id="问题解决之后的效果what">问题解决之后的效果（WHAT）</h2>
<p>1.减少了布局层级嵌套，提高了UI性能。<br>
2.兼容了更多的屏幕尺寸。</p>
<h1 id="怎么使用约束布局">怎么使用约束布局</h1>
<h2 id="添加依赖">添加依赖</h2>
<p>support版本</p>
<blockquote>
<p><code>implementation 'com.android.support.constraint:constraint-layout:1.1.3'</code></p>
</blockquote>
<p>androidx版本</p>
<blockquote>
<p><code>implementation 'androidx.constraintlayout:constraintlayout:1.1.3'</code></p>
</blockquote>
<p>其实从Android Studio 2.3 开始，默认的模板就是用的ConstraintLayout。</p>
<h2 id="相对约束">相对约束</h2>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout_constraintLeft_toLeftOf</td>
<td>控件的左边约束在目标控件的左边</td>
</tr>
<tr>
<td>layout_constraintLeft_toRightOf</td>
<td>控件的左边约束在目标控件的右边</td>
</tr>
<tr>
<td>layout_constraintRight_toLeftOf</td>
<td>控件的右边约束在目标控件的左边</td>
</tr>
<tr>
<td>layout_constraintRight_toRightOf</td>
<td>控件的右边约束在目标控件的右边</td>
</tr>
<tr>
<td>layout_constraintTop_toTopOf</td>
<td>控件的上边约束在目标控件的上边</td>
</tr>
<tr>
<td>layout_constraintTop_toBottomOf</td>
<td>控件的上边约束在目标控件的下边</td>
</tr>
<tr>
<td>layout_constraintBottom_toTopOf</td>
<td>控件的下边约束在目标控件的上边</td>
</tr>
<tr>
<td>layout_constraintBottom_toBottomOf</td>
<td>控件的下边约束在目标控件的下边</td>
</tr>
<tr>
<td>layout_constraintStart_toEndOf</td>
<td>控件的开始边约束在目标控件的结束边（supportsRtl）</td>
</tr>
<tr>
<td>layout_constraintStart_toStartOf</td>
<td>控件的开始边约束在目标控件的开始边（supportsRtl）</td>
</tr>
<tr>
<td>layout_constraintEnd_toStartOf</td>
<td>控件的结束边约束在目标控件的开始边（supportsRtl）</td>
</tr>
<tr>
<td>layout_constraintEnd_toEndOf</td>
<td>控件的结束边约束在目标控件的结束边（supportsRtl）</td>
</tr>
<tr>
<td>layout_constraintBaseline_toBaselineOf</td>
<td>控件的文本约束在目标控件的文本</td>
</tr>
</tbody>
</table>
<h2 id="角度约束">角度约束</h2>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout_constraintCircle</td>
<td>以目标控件为中心</td>
</tr>
<tr>
<td>layout_constraintCircleAngle</td>
<td>角度</td>
</tr>
<tr>
<td>layout_constraintCircleRadius</td>
<td>距离</td>
</tr>
</tbody>
</table>
<h2 id="边距约束">边距约束</h2>
<p>padding和其他布局的效果一样。<br>
margin属性必须要约束到ConstraintLayout里。<br>
margin的值不能为负数。<br>
goneMargin是控件visibility设置为gone时使用到的margin值。</p>
<h2 id="尺寸约束">尺寸约束</h2>
<p>推荐使用MATCH_CONSTRAINT（0dp）而不是match_parent。<br>
ConstraintLayout的宽高为WRAP_CONTENT时可以设置min,max值。<br>
控件的宽高为MATCH_CONSTRAINT时可以设置min，max值。</p>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout_constraintWidth_min</td>
<td>最小宽度</td>
</tr>
<tr>
<td>layout_constraintHeight_min</td>
<td>最小高度</td>
</tr>
<tr>
<td>layout_constraintWidth_max</td>
<td>最大宽度</td>
</tr>
<tr>
<td>layout_constraintHeight_max</td>
<td>最大高度</td>
</tr>
<tr>
<td>layout_constraintWidth_percent</td>
<td>宽度占父级的百分比</td>
</tr>
<tr>
<td>layout_constraintHeight_percent</td>
<td>高度占父级的百分比</td>
</tr>
</tbody>
</table>
<h2 id="宽高比约束">宽高比约束</h2>
<p>使用属性layout_constraintDimensionRatio设置宽高比。<br>
Example：</p>
<blockquote>
<p><code>app:layout_constraintDimensionRatio=&quot;H,2:3&quot;</code>指的是 高:宽=2:3<br>
<code>app:layout_constraintDimensionRatio=&quot;W,2:3&quot;</code>指的是 宽:高=2:3</p>
</blockquote>
<h2 id="链约束">链约束</h2>
<p>链在水平或者垂直方向提供一组类似行为。如图所示可以理解为横向链。这里需要了解一点，A与parent的左边缘约束，B与parent的右边边缘约束，A右边和B左边之间相互约束，才能使用一条链。多个元素之间也是如此，最左最右与parent约束，元素之间边相互约束。不然下面的链式永远无法生效。<br>
<img src="http://www.tianfeifei.com/post-images/1566973857306.png" alt=""><br>
横向链最左边第一个控件，垂直链最顶边第一个控件称为链头，可以通过下面两个属性链头统一定制链的样式。</p>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout_constraintHorizontal_chainStyle</td>
<td>水平方向链式</td>
</tr>
<tr>
<td>layout_constraintVertical_chainStyle</td>
<td>垂直方向链式</td>
</tr>
<tr>
<td>layout_constraintVertical_weight</td>
<td>链中权重</td>
</tr>
</tbody>
</table>
<h2 id="辅助工具">辅助工具</h2>
<h3 id="optimizer优化器">Optimizer（优化器）</h3>
<p>当我们使用 MATCH_CONSTRAINT 时，ConstraintLayout 将对控件进行 2 次测量，可以通过设置 layout_optimizationLevel 进行优化，可设置的值有：</p>
<ul>
<li>none：无优化</li>
<li>standard：仅优化直接约束和屏障约束（默认）</li>
<li>direct：优化直接约束</li>
<li>barrier：优化屏障约束</li>
<li>chain：优化链约束</li>
<li>dimensions：优化尺寸测量</li>
</ul>
<h3 id="guideline参考线">Guideline（参考线）</h3>
<p>Guideline不会出现在界面上，实在编码过程中做参考的。<br>
Guideline可以通过orientation设置水平方向或者垂直方向的参考线。<br>
通过以下属性来定位Guideline的位置：</p>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>layout_constraintGuide_begin</td>
<td>从左边或顶部指定具体的距离</td>
</tr>
<tr>
<td>layout_constraintGuide_end</td>
<td>从右边或底部指定具体的距离</td>
</tr>
<tr>
<td>layout_constraintGuide_percent</td>
<td>从宽度或高度的百分比来指定具体距离</td>
</tr>
</tbody>
</table>
<h3 id="barrier栅栏">Barrier（栅栏）</h3>
<p>Barrier类似于Guideline，但Barrier会根据所有引用的控件尺寸的变化重新定位。<br>
通过以下属性来定位Barrier的位置：</p>
<table>
<thead>
<tr>
<th>属性名称</th>
<th>属性介绍</th>
</tr>
</thead>
<tbody>
<tr>
<td>barrierDirection</td>
<td>所引用控件对齐的位置</td>
</tr>
<tr>
<td>constraint_referenced_ids</td>
<td>所引用的控件（多个控件用“,”隔开）</td>
</tr>
</tbody>
</table>
<h3 id="group组">Group（组）</h3>
<p>把一些控件包含在组里，来进行状态的统一管理。相比于ViewGroup控件，并没有增加布局层级。</p>
<h3 id="placeholder占位符">Placeholder（占位符）</h3>
<p>一个view占位的占位符，当指定Placeholder的content属性为另一个view的id时，该view会移动到Placeholder的位置。</p>
<h1 id="未来">未来</h1>
<p>目前最新版本时1.1.3，马上将要推出2.0.0！<br>
在2.0.0中新增了一些特性。以后会添加进来的。<br>
详细信息请到<a href="https://developer.android.google.cn/reference/android/support/constraint/ConstraintLayout">官网</a>学习查看。</p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="http://www.tianfeifei.com/post/20190809">
              <h3 class="post-title">
                下一篇：【禅道】禅道的设计理念（二）
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">梦开始的地方</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  2019❤Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  
  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: 'd0c4a5c1ab6ea3db037a',
        clientSecret: 'a43e84ad9fa25f009243e2305fb8230e4fb6bb6b',
        repo: 'androidflying.github.io',
        owner: 'androidflying',
        admin: ['androidflying'],
        id: location.pathname,      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
